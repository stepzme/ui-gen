import * as React from "react"
import { cn } from "@/lib/utils"
import { ButtonIcon } from "@/imported/components/ui/buttonIcon"
import { Icon } from "@/imported/components/ui/icon"
import { Typography } from "@/imported/components/meta/typography"

export interface NavbarProps extends React.HTMLAttributes<HTMLDivElement> {
  variant?: 'ios' | 'android'
  rightIcon?: string
  title?: string
  description?: string
  showNavigation?: boolean
  showTitle?: boolean
  showDescription?: boolean
  showRightButton?: boolean
  onLeftClick?: () => void
  onRightClick?: () => void
}

const Navbar = React.forwardRef<HTMLDivElement, NavbarProps>(
  ({ 
    className,
    variant = 'ios',
    rightIcon,
    title,
    description,
    showNavigation = true,
    showTitle = true,
    showDescription = true,
    showRightButton = true,
    onLeftClick,
    onRightClick,
    ...props 
  }, ref) => {
    const isIOS = variant === 'ios'
    
    const timeIosSvg = '<svg width="54" height="18" viewBox="0 0 54 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.2147 3.16748C18.4705 3.16748 20.4334 4.77148 20.4334 8.58008V8.59473C20.4334 12.1543 18.8294 14.2637 16.1707 14.2637C14.2298 14.2637 12.7796 13.1138 12.4427 11.4951L12.428 11.4146H14.2884L14.3104 11.4878C14.5887 12.2275 15.2405 12.7109 16.1707 12.7109C17.848 12.7109 18.5584 11.0703 18.639 9.04883C18.639 8.96826 18.6463 8.8877 18.6463 8.80713H18.4998C18.1116 9.64209 17.1888 10.3818 15.7386 10.3818C13.7098 10.3818 12.2889 8.90234 12.2889 6.89551V6.88086C12.2889 4.73486 13.9222 3.16748 16.2147 3.16748ZM16.2073 8.93164C17.4012 8.93164 18.3167 8.06738 18.3167 6.87354V6.85889C18.3167 5.65039 17.4012 4.70557 16.2293 4.70557C15.0648 4.70557 14.1346 5.63574 14.1346 6.81494V6.82959C14.1346 8.05273 15.0062 8.93164 16.2073 8.93164Z" fill="currentColor"/><path d="M23.4586 7.15186C22.7921 7.15186 22.2941 6.63916 22.2941 5.99463C22.2941 5.34277 22.7921 4.8374 23.4586 4.8374C24.1324 4.8374 24.6232 5.34277 24.6232 5.99463C24.6232 6.63916 24.1324 7.15186 23.4586 7.15186ZM23.4586 12.5864C22.7921 12.5864 22.2941 12.0811 22.2941 11.4292C22.2941 10.7773 22.7921 10.272 23.4586 10.272C24.1324 10.272 24.6232 10.7773 24.6232 11.4292C24.6232 12.0811 24.1324 12.5864 23.4586 12.5864Z" fill="currentColor"/><path d="M31.6108 14V11.9712H26.4399V10.4258C27.8095 8.04541 29.3109 5.61377 30.7465 3.43115H33.4198V10.4111H34.8407V11.9712H33.4198V14H31.6108ZM28.1977 10.4551H31.64V4.93994H31.5302C30.4462 6.59521 29.2231 8.55078 28.1977 10.3452V10.4551Z" fill="currentColor"/><path d="M38.9206 14V5.2915H38.7961L36.1667 7.15186V5.37207L38.9279 3.43115H40.8103V14H38.9206Z" fill="currentColor"/></svg>'
    
    const timeAndroidSvg = '<svg width="27" height="16" viewBox="0 0 27 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M26.9024 7.16602V8.79297C26.9024 9.57227 26.8249 10.2376 26.67 10.7891C26.5196 11.3359 26.3009 11.7803 26.0138 12.1221C25.7266 12.4639 25.3826 12.7145 24.9815 12.874C24.585 13.0335 24.1407 13.1133 23.6485 13.1133C23.2566 13.1133 22.892 13.0632 22.5548 12.9629C22.2221 12.8626 21.9213 12.7054 21.6524 12.4912C21.3835 12.277 21.1534 12.0013 20.962 11.6641C20.7751 11.3223 20.6293 10.9144 20.5245 10.4404C20.4242 9.96647 20.3741 9.41732 20.3741 8.79297V7.16602C20.3741 6.38216 20.4516 5.72135 20.6065 5.18359C20.7615 4.64128 20.9825 4.2015 21.2696 3.86426C21.5567 3.52246 21.8985 3.27409 22.295 3.11914C22.696 2.96419 23.1427 2.88672 23.6348 2.88672C24.0313 2.88672 24.3959 2.93685 24.7286 3.03711C25.0658 3.13281 25.3666 3.28548 25.6309 3.49512C25.8998 3.70475 26.1277 3.97819 26.3145 4.31543C26.5059 4.64811 26.6518 5.05143 26.752 5.52539C26.8523 5.99479 26.9024 6.54167 26.9024 7.16602ZM25.255 9.02539V6.91992C25.255 6.52344 25.2322 6.1748 25.1866 5.87402C25.141 5.56868 25.0727 5.3112 24.9815 5.10156C24.8949 4.88737 24.7856 4.71419 24.6534 4.58203C24.5212 4.44531 24.3708 4.34733 24.2022 4.28809C24.0336 4.22428 23.8445 4.19238 23.6348 4.19238C23.3796 4.19238 23.1518 4.24251 22.9513 4.34277C22.7507 4.43848 22.5821 4.59342 22.4454 4.80762C22.3087 5.02181 22.2039 5.30436 22.1309 5.65527C22.0626 6.00163 22.0284 6.42318 22.0284 6.91992V9.02539C22.0284 9.42643 22.0512 9.77962 22.0968 10.085C22.1423 10.3903 22.2107 10.6523 22.3018 10.8711C22.393 11.0853 22.5024 11.263 22.63 11.4043C22.7621 11.541 22.9125 11.6413 23.0811 11.7051C23.2543 11.7689 23.4434 11.8008 23.6485 11.8008C23.9083 11.8008 24.1384 11.7507 24.3389 11.6504C24.5395 11.5501 24.7081 11.3906 24.8448 11.1719C24.9815 10.9486 25.0841 10.6592 25.1524 10.3037C25.2208 9.94824 25.255 9.52214 25.255 9.02539Z" fill="currentColor"/><path fill-rule="evenodd" clip-rule="evenodd" d="M1.44238 11.6777H1.5791C2.20801 11.6777 2.7321 11.5957 3.15137 11.4316C3.5752 11.263 3.91243 11.0306 4.16309 10.7344C4.41374 10.4382 4.59375 10.0895 4.70312 9.68848C4.78057 9.40451 4.8306 9.10341 4.85321 8.78517C4.59988 9.06425 4.30126 9.28907 3.95801 9.45605C3.62533 9.62012 3.26302 9.70215 2.87109 9.70215C2.39714 9.70215 1.97786 9.61328 1.61328 9.43555C1.25326 9.25326 0.952474 9.00716 0.710938 8.69727C0.473958 8.38737 0.296224 8.0319 0.177734 7.63086C0.0592448 7.22982 0 6.80827 0 6.36621C0 5.8877 0.0729167 5.4388 0.21875 5.01953C0.364583 4.60026 0.576497 4.23112 0.854492 3.91211C1.13249 3.58854 1.46973 3.33789 1.86621 3.16016C2.26725 2.97786 2.7207 2.88672 3.22656 2.88672C3.76432 2.88672 4.236 2.99154 4.6416 3.20117C5.0472 3.41081 5.389 3.7002 5.66699 4.06934C5.94499 4.43848 6.15462 4.86686 6.2959 5.35449C6.43717 5.84212 6.50781 6.36621 6.50781 6.92676V7.50781C6.50781 8.0957 6.4554 8.66309 6.35059 9.20996C6.24577 9.75228 6.07487 10.2559 5.83789 10.7207C5.60547 11.181 5.29785 11.5866 4.91504 11.9375C4.53678 12.2839 4.07194 12.555 3.52051 12.751C2.97363 12.9424 2.33105 13.0381 1.59277 13.0381H1.44238V11.6777ZM4.7373 5.60059C4.82389 5.90592 4.86719 6.26139 4.86719 6.66699V7.32511C4.77665 7.52856 4.6536 7.71251 4.49805 7.87695C4.33854 8.04557 4.15169 8.18001 3.9375 8.28027C3.72331 8.37598 3.48861 8.42383 3.2334 8.42383C2.96452 8.42383 2.72982 8.36686 2.5293 8.25293C2.32878 8.139 2.16243 7.98405 2.03027 7.78809C1.89811 7.59212 1.79785 7.36882 1.72949 7.11816C1.66569 6.86296 1.63379 6.59863 1.63379 6.3252C1.63379 6.03353 1.66797 5.76009 1.73633 5.50488C1.80924 5.24512 1.91178 5.01953 2.04395 4.82812C2.18066 4.63216 2.34701 4.47949 2.54297 4.37012C2.74349 4.25618 2.96908 4.19922 3.21973 4.19922C3.44759 4.19922 3.65951 4.25163 3.85547 4.35645C4.05599 4.46126 4.23145 4.61849 4.38184 4.82812C4.53678 5.0332 4.65527 5.29069 4.7373 5.60059Z" fill="currentColor"/><path fill-rule="evenodd" clip-rule="evenodd" d="M8.72594 11.5137C8.55276 11.6868 8.46617 11.901 8.46617 12.1562C8.46617 12.4115 8.55276 12.6257 8.72594 12.7988C8.89911 12.972 9.13382 13.0586 9.43004 13.0586C9.73082 13.0586 9.96552 12.972 10.1341 12.7988C10.3073 12.6257 10.3939 12.4115 10.3939 12.1562C10.3939 11.901 10.3073 11.6868 10.1341 11.5137C9.96552 11.3359 9.73082 11.2471 9.43004 11.2471C9.13382 11.2471 8.89911 11.3359 8.72594 11.5137Z" fill="currentColor"/><path d="M8.47301 6.33203C8.47301 6.07682 8.5596 5.86263 8.73277 5.68945C8.90595 5.51172 9.14065 5.42285 9.43688 5.42285C9.73766 5.42285 9.97236 5.51172 10.141 5.68945C10.3142 5.86263 10.4007 6.07682 10.4007 6.33203C10.4007 6.58724 10.3142 6.80143 10.141 6.97461C9.97236 7.14779 9.73766 7.23438 9.43688 7.23438C9.14065 7.23438 8.90595 7.14779 8.73277 6.97461C8.5596 6.80143 8.47301 6.58724 8.47301 6.33203Z" fill="currentColor"/><path d="M14.1159 7.25488H15.1003C15.4831 7.25488 15.7999 7.1888 16.0505 7.05664C16.3057 6.92448 16.4948 6.74219 16.6179 6.50977C16.7409 6.27734 16.8025 6.01074 16.8025 5.70996C16.8025 5.39551 16.7455 5.12663 16.6316 4.90332C16.5222 4.67546 16.3536 4.5 16.1257 4.37695C15.9024 4.25391 15.6176 4.19238 15.2712 4.19238C14.9795 4.19238 14.7152 4.25163 14.4782 4.37012C14.2458 4.48405 14.0612 4.64811 13.9245 4.8623C13.7878 5.07194 13.7195 5.32259 13.7195 5.61426H12.0652C12.0652 5.08561 12.2042 4.61621 12.4821 4.20605C12.7601 3.7959 13.1384 3.47461 13.6169 3.24219C14.1 3.00521 14.6423 2.88672 15.2439 2.88672C15.8864 2.88672 16.447 2.99382 16.9255 3.20801C17.4086 3.41764 17.7846 3.7321 18.0534 4.15137C18.3223 4.57064 18.4568 5.09017 18.4568 5.70996C18.4568 5.99251 18.3907 6.27962 18.2585 6.57129C18.1264 6.86296 17.9304 7.12956 17.6706 7.37109C17.4587 7.56439 17.2044 7.72888 16.9076 7.86456C17.2931 7.99934 17.609 8.1812 17.8552 8.41016C18.115 8.64714 18.3041 8.91829 18.4226 9.22363C18.5456 9.52897 18.6071 9.85254 18.6071 10.1943C18.6071 10.6592 18.5228 11.0739 18.3542 11.4385C18.1902 11.7985 17.9555 12.1038 17.6501 12.3545C17.3448 12.6051 16.987 12.7943 16.5769 12.9219C16.1713 13.0495 15.7292 13.1133 15.2507 13.1133C14.8223 13.1133 14.4122 13.054 14.0202 12.9355C13.6283 12.8171 13.2774 12.6416 12.9675 12.4092C12.6576 12.1722 12.4115 11.8783 12.2292 11.5273C12.0515 11.1719 11.9626 10.7617 11.9626 10.2969H13.6101C13.6101 10.5931 13.6784 10.8551 13.8152 11.083C13.9564 11.3063 14.1524 11.4818 14.403 11.6094C14.6583 11.737 14.9499 11.8008 15.278 11.8008C15.6244 11.8008 15.9229 11.7393 16.1736 11.6162C16.4242 11.4932 16.6156 11.3109 16.7478 11.0693C16.8845 10.8278 16.9529 10.5361 16.9529 10.1943C16.9529 9.80697 16.8777 9.49251 16.7273 9.25098C16.5769 9.00944 16.3627 8.83171 16.0847 8.71777C15.8067 8.59928 15.4786 8.54004 15.1003 8.54004H14.1159V7.25488Z" fill="currentColor"/></svg>'
    
    const statusIconsIosSvg = '<svg width="68" height="16" viewBox="0 0 68 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M62.4167 3.08466C63.7974 3.08466 64.9167 4.20394 64.9167 5.58466V11.0847C64.9167 12.4654 63.7974 13.5847 62.4167 13.5847H45.4167C44.036 13.5847 42.9167 12.4654 42.9167 11.0847V5.58466C42.9167 4.20394 44.036 3.08466 45.4167 3.08466H62.4167ZM45.9167 4.08466C44.8121 4.08466 43.9167 4.98009 43.9167 6.08466V10.5847C43.9167 11.6892 44.8121 12.5847 45.9167 12.5847H61.9167C63.0213 12.5847 63.9167 11.6892 63.9167 10.5847V6.08466C63.9167 4.98009 63.0213 4.08466 61.9167 4.08466H45.9167Z" fill="currentColor"/><path d="M65.9167 6.58661C66.7789 6.80876 67.4165 7.58964 67.4167 8.52118C67.4167 9.45285 66.7789 10.2335 65.9167 10.4557V6.58661Z" fill="currentColor"/><path d="M44.9167 6.08466C44.9167 5.53237 45.3644 5.08466 45.9167 5.08466H61.9167C62.469 5.08466 62.9167 5.53237 62.9167 6.08466V10.5847C62.9167 11.1369 62.469 11.5847 61.9167 11.5847H45.9167C45.3644 11.5847 44.9167 11.1369 44.9167 10.5847V6.08466Z" fill="currentColor"/><path fill-rule="evenodd" clip-rule="evenodd" d="M30.247 4.69267C32.4629 4.69277 34.5941 5.54421 36.2 7.071C36.321 7.18888 36.5142 7.18739 36.6334 7.06767L37.7894 5.901C37.8497 5.84028 37.8833 5.75803 37.8828 5.67245C37.8823 5.58687 37.8477 5.50502 37.7867 5.445C33.5716 1.40546 26.9218 1.40546 22.7067 5.445C22.6456 5.50497 22.611 5.5868 22.6104 5.67238C22.6099 5.75796 22.6434 5.84024 22.7037 5.901L23.86 7.06767C23.979 7.18757 24.1725 7.18906 24.2934 7.071C25.8995 5.54411 28.0309 4.69267 30.247 4.69267V4.69267ZM30.247 8.48834C31.4645 8.48826 32.6385 8.9408 33.541 9.758C33.6631 9.87399 33.8554 9.87147 33.9744 9.75234L35.129 8.58567C35.1898 8.52448 35.2236 8.44146 35.2227 8.3552C35.2218 8.26893 35.1864 8.18662 35.1244 8.12667C32.3762 5.57029 28.1202 5.57029 25.372 8.12667C25.3099 8.18662 25.2745 8.26897 25.2737 8.35526C25.2729 8.44156 25.3068 8.52456 25.3677 8.58567L26.522 9.75234C26.641 9.87147 26.8333 9.87399 26.9554 9.758C27.8572 8.94134 29.0303 8.48884 30.247 8.48834V8.48834ZM32.466 11.2727C32.5278 11.2121 32.5618 11.1287 32.56 11.0422C32.5582 10.9556 32.5209 10.8737 32.4567 10.8157C31.1811 9.73679 29.3129 9.73679 28.0374 10.8157C27.9731 10.8737 27.9357 10.9556 27.9339 11.0421C27.932 11.1286 27.966 11.212 28.0277 11.2727L30.0254 13.2883C30.0839 13.3476 30.1637 13.3809 30.247 13.3809C30.3303 13.3809 30.4101 13.3476 30.4687 13.2883L32.466 11.2727Z" fill="currentColor"/><path fill-rule="evenodd" clip-rule="evenodd" d="M1.58331 9.41798H2.58331C3.1356 9.41798 3.58331 9.86569 3.58331 10.418V12.418C3.58331 12.9703 3.1356 13.418 2.58331 13.418H1.58331C1.03103 13.418 0.583313 12.9703 0.583313 12.418V10.418C0.583313 9.86569 1.03103 9.41798 1.58331 9.41798V9.41798ZM6.24998 7.41798H7.24998C7.80226 7.41798 8.24998 7.86569 8.24998 8.41798V12.418C8.24998 12.9703 7.80226 13.418 7.24998 13.418H6.24998C5.69769 13.418 5.24998 12.9703 5.24998 12.418V8.41798C5.24998 7.86569 5.69769 7.41798 6.24998 7.41798ZM10.9166 5.08465H11.9166C12.4689 5.08465 12.9166 5.53236 12.9166 6.08465V12.418C12.9166 12.9703 12.4689 13.418 11.9166 13.418H10.9166C10.3644 13.418 9.91665 12.9703 9.91665 12.418V6.08465C9.91665 5.53236 10.3644 5.08465 10.9166 5.08465ZM15.5833 2.75131H16.5833C17.1356 2.75131 17.5833 3.19903 17.5833 3.75131V12.418C17.5833 12.9703 17.1356 13.418 16.5833 13.418H15.5833C15.031 13.418 14.5833 12.9703 14.5833 12.418V3.75131C14.5833 3.19903 15.031 2.75131 15.5833 2.75131V2.75131Z" fill="currentColor"/></svg>'
    
    const statusIconsAndroidSvg = '<svg width="46" height="16" viewBox="0 0 46 16" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_4865_632)"><path opacity="0.1" d="M8.5 0.916656C5.1 0.916656 2.125 2.40416 0 4.74166L8.5 15.0833L17 4.74166C14.875 2.40416 11.9 0.916656 8.5 0.916656Z" fill="currentColor"/><path d="M31.5833 0.916656L17.4167 15.0833H31.5833V0.916656V0.916656Z" fill="currentColor"/><path opacity="0.3" d="M43.5 0.5H40.5V2H39C38.4477 2 38 2.50368 38 3.125V14.375C38 14.9963 38.4477 15.5 39 15.5H45C45.5523 15.5 46 14.9963 46 14.375V3.125C46 2.50368 45.5523 2 45 2H43.5V0.5Z" fill="currentColor"/><path d="M38 8.5C38 9.08333 38 13.8667 38 14.45C38 15.0299 38.4477 15.5 39 15.5H45C45.5523 15.5 46 15.0299 46 14.45C46 13.8667 46 9.08333 46 8.5H38Z" fill="currentColor"/></g><defs><clipPath id="clip0_4865_632"><rect width="46" height="16" fill="white"/></clipPath></defs></svg>'

    const timeSvg = isIOS ? timeIosSvg : timeAndroidSvg
    const statusIconsSvg = isIOS ? statusIconsIosSvg : statusIconsAndroidSvg

    return (
      <div
        ref={ref}
        className={cn(
          "absolute top-0 left-0 right-0 z-50 pointer-events-none",
          className
        )}
        {...props}
      >
        {/* Status Bar */}
        <div className={cn(
          "flex items-center justify-between px-4 bg-background-primary text-foreground-primary",
          isIOS ? "h-12" : "h-6"
        )}>
          <div 
            className="flex items-center text-foreground-primary"
            dangerouslySetInnerHTML={{ __html: timeSvg }}
            style={{ display: 'flex', alignItems: 'center' }}
            aria-hidden="true"
          />
          <div 
            className="flex items-center text-foreground-primary"
            dangerouslySetInnerHTML={{ __html: statusIconsSvg }}
            style={{ display: 'flex', alignItems: 'center' }}
            aria-hidden="true"
          />
        </div>

        {/* Navigation Bar */}
        {showNavigation && (
        <div
          className={cn("flex items-center justify-between px-4 h-14 bg-background-primary")}
        >
          {/* Left Icon Button */}
            <ButtonIcon
              icon="chevron_left"
            onClick={onLeftClick}
              className="pointer-events-auto"
            aria-label="Back"
            />

          {/* Center Content */}
          <div className="flex-1 flex flex-col items-center justify-center px-4">
              {showTitle && title && (
                <Typography 
                  typography="bodyS_tight_medium" 
                  className="text-center truncate w-full text-foreground-primary"
                >
                {title}
                </Typography>
            )}
              {showDescription && description && (
                <Typography 
                  typography="bodyS_paragraph_normal" 
                  className="text-center truncate w-full text-foreground-secondary"
                >
                {description}
                </Typography>
            )}
          </div>

          {/* Right Icon Button */}
            <ButtonIcon
              icon={rightIcon || "three_dots_vert"}
            onClick={onRightClick}
              className={cn(
                "pointer-events-auto",
                !showRightButton && "opacity-0 pointer-events-none"
              )}
            aria-label="More options"
            />
        </div>
        )}
      </div>
    )
  }
)

Navbar.displayName = "Navbar"

export { Navbar }

